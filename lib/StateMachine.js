"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor;}var events=require('events');var has=function has(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop);};var StateMachine=/*#__PURE__*/function(){function StateMachine(states){_classCallCheck(this,StateMachine);this.state='';this.prevState='';this.states=states;var emitter=new events.EventEmitter();this.emit=emitter.emit.bind(emitter);this.once=emitter.once.bind(emitter);this.on=emitter.on.bind(emitter);this.off=emitter.removeListener.bind(emitter);}_createClass(StateMachine,[{key:"_apply",value:function _apply(state,fn){if(has(this.states,state)&&has(this.states[state],fn)){var _this$states$state$fn;for(var _len=arguments.length,args=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){args[_key-2]=arguments[_key];}(_this$states$state$fn=this.states[state][fn]).call.apply(_this$states$state$fn,[this].concat(args));}}},{key:"transition",value:function transition(to){if(!has(this.states,to)){throw new Error("Can't transition, state ".concat(to," doesn't exist!"));}this.prevState=this.state;this.state=to;this._apply(this.prevState,'exit');for(var _len2=arguments.length,args=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){args[_key2-1]=arguments[_key2];}this._apply.apply(this,[this.state,'enter'].concat(args));}},{key:"handle",value:function handle(input){for(var _len3=arguments.length,args=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){args[_key3-1]=arguments[_key3];}this._apply.apply(this,[this.state,input].concat(args));}}]);return StateMachine;}();module.exports=StateMachine;